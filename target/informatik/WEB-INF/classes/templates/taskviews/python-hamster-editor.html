<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code-Editor</title>
    <link th:href="@{/css/python-hamster-editor.css}" href="python-hamster-editor.css" rel="stylesheet"
        type="text/css" />
    <link th:href="@{/css/python-hamster-assets.css}" href="python-hamster-assets.css" rel="stylesheet"
        type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.2/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.2/mode-python.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.2/theme-monokai.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.2/ext-language_tools.js"></script>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked@9.1.6/marked.min.js"></script>
</head>

<body>
    <div class="mycontainer">
        <!-- Header mit Buttons und Dropdown -->
        <header class="header">
            <div class="button-group">
                <button id="runBtn" class="btn btn-primary" disabled style="opacity: 0.6;"><i class="fas fa-play"></i>
                    Ausf√ºhren</button>
            </div>
            <div class="controls">
                <span id="save-status" class="fas fa-circle text-muted" style="font-size: 0.8rem; cursor: help;"
                    data-title="Bereit zum Speichern"></span>
                <button id="saveButton" class="btn btn-success btn-sm"><i class='fas fa-save'></i> Speichern</button>
                <button id="submitButton" class="btn btn-primary btn-sm"><i class='fas fa-paper-plane'></i>
                    Abgeben</button>
                <button id="configSelector" class="btn btn-secondary btn-sm">1/1</button>
                <button id="speedSelector" class="btn btn-secondary btn-sm"><i class="fas fa-tachometer-alt"></i>
                    0ms</button>
                <label for="fontSizeSelect"><i class="fas fa-text-height"></i></label>
                <select id="fontSizeSelect" class="dropdown">
                    <option value="12">12pt</option>
                    <option value="14" selected>14pt</option>
                    <option value="18">18pt</option>
                    <option value="24">24pt</option>
                    <option value="30">30pt</option>
                </select>
                <a th:href="@{/student/dashboard}" href="/student/dashboard" class="btn btn-outline-secondary btn-sm"><i class='fas fa-house'></i></a>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Editor Panel -->
            <div class="editor-panel">
                <div class="tab-container">
                    <div class="tabs">
                        <button class="editor-tab active" data-tab="python">Python</button>
                    </div>
                </div>
                <div class="editor-container">
                    <div id="pythonEditor" class="editor-content active"></div>
                </div>
            </div>

            <!-- Resizable Splitter -->
            <div class="splitter" id="splitter"></div>

            <!-- Output Panel -->
            <div class="output-panel">
                <div class="tab-container">
                    <div class="tabs">
                        <button class="output-tab active" data-output-tab="result">Ausgabe</button>
                        <button class="output-tab" data-output-tab="task">Aufgabe</button>
                        <button class="output-tab" data-output-tab="tutorial">Tutorial</button>
                    </div>
                    <button id="clearOutputBtn" class="btn btn-outline-secondary btn-sm"><i
                            class="fas fa-trash"></i></button>
                </div>
                <div class="output-container">
                    <div id="resultOutput" class="output-content active">
                        <!-- Hamster Territory Display -->
                        <div id="hamsterTerritory" class="hamster-territory"></div>
                        <!-- Console Output (halved height) -->
                        <div id="consoleOutput" class="console-output console-half-height"></div>
                    </div>
                    <div id="taskOutput" class="output-content">
                        <!-- Markdown-gerenderte Anleitung -->
                    </div>
                    <div id="tutorialOutput" class="output-content">
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="task-save-url" style="display: none"
        th:attr="data-url=${(isTeacherView ?: false) and (userTaskId != null) ? '/api/tasks/usertasks/' + userTaskId + '/content' : '/api/tasks/' + task.id + '/content'}"
        data-url="/dev/save"></div>
    <div id="task-submit-url" style="display: none"
        th:attr="data-url=${(isTeacherView ?: false) and (userTaskId != null) ? '' : '/api/tasks/' + task.id + '/submit'}"
        data-url="/dev/submit"></div>
    <div id="currentContent" style="display: none" th:text="${currentContent}">{"version":"1.0","type":"python-code-editor","pythonCode":"# Test 2","currentTutorialIndex":0,"currentConfigIndex":1,"animationSpeed":0,"metadata":{"lastModified":"2025-08-11T04:27:40.336Z","codeLength":8}}</div>
    <div id="description" style="display: none" th:text="${task.description}">*Test*</div>
    <div id="tutorial" style="display: none" th:utext="${task.tutorial}">[
        {
        title: "Grundlagen der p-q-Formel",
        content: `# Tutorial 1: Grundlagen der p-q-Formel`
        },
        {
        title: "Grundlagen der p-q-Formel",
        content: `# Tutorial 2: Grundlagen der p-q-Formel`
        }]
    </div>
    <div id="hamsterConfig" style="display: none" th:text="${task.defaultSubmission}">{
        "configurations": [
        {
        "name": "Einfach",
        "hamsterX": 1,
        "hamsterY": 1,
        "hamsterDirection": "east",
        "hamsterGrains": 0,
        "territory": [
        "w|0|0|w|w|0|0|w|0|0|w|w|0|0|w",
        "0|2|1|0|0|2|1|0|2|1|0|0|2|1|0"
        ]
        },
        {
        "name": "Komplex",
        "hamsterX": 0,
        "hamsterY": 0,
        "hamsterDirection": "south",
        "hamsterGrains": 3,
        "territory": [
        "w|3|0|w|0",
        "0|w|1|0|2",
        "1|0|0|w|0"
        ]
        }
        ],
        "defaultContent": "# Hamster-Programm\nvor()\nlinksUm()\nvor()\nnimm()\ngib()"
        }</div>

    <script th:src="@{/js/python-hamster-editor.js}" src="python-hamster-editor.js"></script>
</body>

</html>