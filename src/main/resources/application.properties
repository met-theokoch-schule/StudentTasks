# Server Configuration
server.port=5000
server.address=0.0.0.0
server.servlet.context-path=
server.forward-headers-strategy=framework

# Database Configuration (H2 In-Memory)
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.h2.console.enabled=true

# Disable SQL script initialization since we use DataInitializer
spring.sql.init.mode=never

# Connection Pool Configuration
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# Logging
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.oauth2=DEBUG

# OAuth2 / OpenID Connect Configuration - Manuelle Konfiguration
# Configuration wird aus oidc.properties geladen
spring.security.oauth2.client.registration.oidc.client-id=${oidc.client.id}
spring.security.oauth2.client.registration.oidc.client-secret=${oidc.client.secret}
spring.security.oauth2.client.registration.oidc.scope=openid,profile,email,groups,roles
spring.security.oauth2.client.registration.oidc.authorization-grant-type=authorization_code
# Dynamische Redirect-URI - verwendet baseUrl vom Request
spring.security.oauth2.client.registration.oidc.redirect-uri={baseUrl}/login/oauth2/code/{registrationId}

# OpenID Connect Provider Configuration - Manuelle Endpunkt-Konfiguration
# KEINE issuer-uri verwenden, um automatische Discovery zu deaktivieren
spring.security.oauth2.client.provider.oidc.authorization-uri=${oidc.provider.authorization-uri}
spring.security.oauth2.client.provider.oidc.token-uri=${oidc.provider.token-uri}
spring.security.oauth2.client.provider.oidc.user-info-uri=${oidc.provider.userinfo-uri}
spring.security.oauth2.client.provider.oidc.jwk-set-uri=${oidc.provider.jwk-set-uri}
spring.security.oauth2.client.provider.oidc.user-name-attribute=sub

# Include OIDC properties file
spring.config.import=classpath:oidc.properties

# Thymeleaf Configuration
spring.thymeleaf.cache=false
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html
spring.thymeleaf.mode=HTML
spring.thymeleaf.encoding=UTF-8